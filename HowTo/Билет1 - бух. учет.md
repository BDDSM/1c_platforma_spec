# Анализ билета

Выделяем ключевые особенности решения 1-2 словами, чтобы потом по этому чек-листу разрабатывать решение

* Создать документ "Операция"
* Учет в разрезе сроков годности (Дата) / указывается в ТЧ
* Списание при продаже - от мин. срока
* Себестоимость - средняя по товару вцелом
* Отчет по кол-ву и сумме в разрезе товаров и сроков годности
  * Сумма расчетная! = [СредняяЦена] * [КоличествоПоСроку]
    * СредняяЦена = [СебестоимостьПоТовару] / [КоличествоТовара]

Полезно выписать проводки на листок, чтобы потом не смотреть в билет:

* Приходная накладная
  * *ДТ "Товары" = КТ "Поставщики" на кол-во и сумму закупа*
  
* Расходная накладная
  * *ДТ "Прибыли и убытки" = КТ "Товары" на кол-во и сумму себестоимости*
  * *ДТ "Покупатели" = КТ "Прибыли и убытки" на кол-во и сумму продажи*

**Проектирование регистра начинается с анализа отчета!**

* В отчете есть аналитики: *Товар* и *Срок годности*: значит  будет минимум 2 субконто: *Номенклатура*, *Срок годности*
  * В других билетах одна из аналитик может быть измерением. Чаще всего: *Организация*

* В отчете есть данные по количеству, а значит должен быть ресурс *Количество*. Настройки этого ресурса одинаковы для всех задач:
  * Заводится признак ведения учета *Количественный*
  * Признак подключается к нужному счету (в нашем случае это счет *Товары*)
  * У ресурса регистра отключить признак *балансовый*

* Как достать количество?
  * Из таблицы остатков *Регистра Бухгалтерии*. Отборы и поля:
    * Счет: *Товары*
    * Субконто: *Номенклатура*, *СрокГодности*
    * берём реквизит *КоличествоОСтаток*

* как достать данные для расчета суммы?
  * Из таблицы остатков *Регистра Бухгалтерии*. Отборы и поля:
    * Счет: *Товары*
    * Субконто: *Товары*
    * Формула: *СуммаОстаток* / *КоличествоОстаток* с проверкой на 0
* Итого: 2 запроса и соединение меду ними (в нашем случае *внутреннее* ибо один и тот же счет за один и тот же период)

**ВАЖНО! Актуально для всех задач всех учётов** Подобный анализ требуется делать ВСЕГДА ДО решения билета, а то потом возможны ситуации, когда отчет не собирается!

Дальше анализируем другие условия: есть ли там доп. аналитики или специфические условия, кроме выявленных в отчете? В нашем случае нет, поэтому можно приступать к решению билета
