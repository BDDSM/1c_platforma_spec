# Билет 1 - решение задачи по бух. учёту

**Дисклеймер** Данные записи, по-сути, практическая выжимка решения, теор. часть практически не разбирается! Поэтому важен теоретических базис от любого доступного источника: Курс 1С УЦ, Курс Гилёва, Курс Чистова, практическое пособие разработчика и т.д.

## Краткая справка

---

1. Билет по расчетам имеет строгую и не противоречивую логику разбора и выработки решения. Она хорошо изложена в курсе от УЦ 1С. Очень советую его прослушать

2. Существует 3 времени:
    * *Календарное время* - всё просто: 365/366 дней по 24 часа
    * *Плановое рабочее время* - сколько вы должны отработать в указанный период: неделю, месяц, квартал и т.д. 
    * *Фактически отработанное время* - сколько вы по факту отработали

3. Существует 4 периода:
    * *Период регистрации* - в каком месяце событие зарегистрировано: в марте я регистрирую начисление за март. А могу это событие зарегистрировать и в апреле, но за март.
    * *Период действия (план)* - сколько по плану длится начисление, можно сказать что это то самое плановое время, т.е. те самые 40 часов в неделю.
    * *период действия (факт)* - сколько по факту подлежит начислению в это месяце, т.е. по плану должно было быть 40, но 1 день я отпросился, поэтому остаётся 32 часа
    * *Базовый период* - На базе чего рассчитывать начисление, н-р: "премия считается как % от заработанного в прошлом месяце", вот "прошлый месяц" - это и есть базовый период.

4. Учет фактического времени может вестись двумя вариантами (об этом напрямую будет сказано в билете):
    * *Метод отклонения* - когда события регистрируются в течении учетного периода, а потом, при подсчете результата, получаем результат по данным специально виртуальной таблицы *Данные графика*
    * *Работа по графику* - когда мы вносим данные по факту работы в конце периода регламентным документом, н-р: "График"

5. При построении решения обязательно использовать следующие метаданные (за не использование сразу неуд.):
    * Планы видов расчета
      * в них и происходит вся настройка каждого отдельного вида расчета
      * Все виды расчета нужно заводить предопределёнными
    * Регистры расчета
      * строится на основании планов видов расчёта
        * Всегда будет иметь 1 измерение *Сотрудник* и 1 Ресурс *Результат*, остальное зависит от билета

6. Отчеты в данном виде задач чаще всего строятся по основной таблице регистра
    * Все дополнительные аналитики выносятся в реквизиты, если по условию задачи не следует чего-либо другого
    * Все дополнительные числовые поля, кроме результата расчета так же выносятся в ресурсы (н-р: % премии и трудовой стаж)
    * Раз мы используем основную таблицу регистра, не забываем ставить отбор на активность записей
      * В основной таблице регистра есть признак "Активность" = ЛОЖЬ строка не влияет на виртуальные таблицы

## Анализ билета

---

Выделяем ключевые особенности решения 1-2 словами, чтобы потом по этому чек-листу разрабатывать решение

* Используемые документы: "Начисление зарплаты"
* Используется метод отклонений
* *Подразделение* - можно не обрабатывать (нет совместительства и нет в отчете)
* В регистре *Данные графика* нужна доп. аналитика *Графики работы*
* Первый вид расчета: ОКЛАД = [ЧасыФакт] * [ДневнаяСтавка]
  * *ЧасыФакт* - данные графика (*Период действия (факт)*)
  * *ДневнаяСтавка* = [НачальноеЗначениеОклада] / [ЧасыПлан]
    * *НачальноеЗначениеОклада* - данные регистра сведений на начало месяца
    * *ЧасыПлан* - данные графика (*Период действия (план)*)
* Второй вид расчета: ПРЕМИЯ = [Процент] * [ОКЛАД]
  * *Процент* - определяется по шкале значений
    * Шкала значений зависит от стажа и необходима будет дату устройства на работу, чтобы вычислить стаж
  * *ОКЛАД* - начисленный **в том же месяце** ОКЛАД (*базовый период* = этот месяц)
* Перерасчетов нет (это отлично)
* На форме необходима кнопка "Рассчитать"
* Переход из периода в период недопустим (это отлично, работы меньше)
* Отчет только за один месяц и он достаточно простой

**Проектирование решение строго регламентированное!**

Общий алгоритм:

1. Выяснить сколько вообще начислений удержаний у нас есть и как они вычисляются

2. Настройка зависимостей между получившимися видами расчета и включить, если требуется, зависимость по периоду действия

| Вид расчета | Вытесняющий | Базовый | Ведущий  | Учет по периоду действия |
| :---------- | :---------: | :-----: | :------: | -----------------------: |


3. Определить порядок расчета

Анализ нашей задачи:

| Вид расчета | Вытесняющий | Базовый | Ведущий  | Учет по периоду действия |
| :---------- | :---------: | :-----: | :------: | -----------------------: |
| **Оклад**   | -           | -       | Х        | +                        |
| Премия      | х           | ОКЛАД   | Х        | -                        |

* У нас 2 вида расчета: Оклад и Премия
* Вписываем оклад
  * Оклад зависит от факта отработанного времени, значит есть учет по периоду действия
  * У нас нет больничных, прогулов и т.д., а значит нет вытеснений
  * Оклад не зависит от других видов расчета, поэтому базовых нет
  * Ведущий - используются только если есть перерасчёты, у нас их нет
* Вписываем премию
  * Премия не зависит от периода действия, хотя и используется часы план, т.к. неважно сколько отработал сотрудник!
  * Раз нет периода действия - значит нет вытеснений
  * Так как считается на основании оклада - значит у него есть база - *ОКЛАД*  
  * Ведущий - используются только если есть перерасчёты, у нас их нет
* Определяем порядок расчета
  * Премия зависит от оклада, поэтому считается строго ПОСЛЕ расчета оклада!
